#!/bin/bash

cookie_hash=$(snapctl get semaphore cookie_hash)

if [ -z "$cookie_hash" ]
then
  cookie_hash=$(tr -dc A-Za-z0-9 </dev/urandom | head -c 40 ; echo '')
  snapctl set semaphore cookie_hash "$cookie_hash"
fi

cookie_encryption=$(snapctl get semaphore cookie_encryption)

if [ -z "$cookie_encryption" ]
then
  cookie_encryption=$(tr -dc A-Za-z0-9 </dev/urandom | head -c 40 ; echo '')
  snapctl set semaphore cookie_encryption "$cookie_encryption"
fi

touch "$SNAP_USER_COMMON/config_changed"